import pandas as pd
import os

# Load all datasets
games_df = load_csv(games_path)
team_stats_df = load_csv(team_stats_path)
players_df = load_csv(players_path)
player_stats_df = load_csv(player_stats_path)
league_schedule_df = load_csv(league_schedule_path)
team_histories_df = load_csv(team_histories_path)

# Ensure datasets were loaded before proceeding
if games_df is not None and team_stats_df is not None:
    # Merge Games with Team Statistics on `team_id`
    merged_games_df = pd.merge(games_df, team_stats_df, on="team_id", how="left")
    merged_games_df.to_csv("data/merged_games_team_stats.csv", index=False)
    print("âœ… Merged Games with Team Statistics")

if players_df is not None and player_stats_df is not None:
    # Merge Players with Player Statistics on `person_id`
    merged_players_df = pd.merge(players_df, player_stats_df, on="person_id", how="left")
    merged_players_df.to_csv("data/merged_players_stats.csv", index=False)
    print("âœ… Merged Players with Player Statistics")

if league_schedule_df is not None and games_df is not None:
    # Merge League Schedule with Games on `game_id`
    merged_league_df = pd.merge(league_schedule_df, games_df, on="game_id", how="left")
    merged_league_df.to_csv("data/merged_league_games.csv", index=False)
    print("âœ… Merged League Schedule with Games")

if team_histories_df is not None and team_stats_df is not None:
    # Merge Team Histories with Team Statistics on `team_id`
    merged_teams_df = pd.merge(team_histories_df, team_stats_df, on="team_id", how="left")
    merged_teams_df.to_csv("data/merged_team_histories.csv", index=False)
    print("âœ… Merged Team Histories with Team Statistics")

print("ðŸ’¾ All merged datasets saved in 'data/' directory.")
